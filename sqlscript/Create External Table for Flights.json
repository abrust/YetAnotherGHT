{
	"name": "Create External Table for Flights",
	"properties": {
		"content": {
			"query": "CREATE MASTER KEY\n\nCREATE DATABASE SCOPED CREDENTIAL [FlightsCred]\nWITH IDENTITY='SHARED ACCESS SIGNATURE',  \nSECRET = 'sv=2020-02-10&st=2023-11-05T03%3A11%3A28Z&se=2023-11-06T04%3A11%3A28Z&sr=d&sp=rl&sig=KnmCTbh548K2UUvHdXpnEvQtUNxaLCdMKevHWgSrfl8%3D&sdd=1'\n\nCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat]\nWITH ( FORMAT_TYPE = PARQUET )\n\nCREATE EXTERNAL DATA SOURCE [myGen2FS]\nWITH (\n\tLOCATION   = 'abfs://bluebadgegen2fs@bluebadgegen22sa.dfs.core.windows.net/',\n\tCREDENTIAL = FlightsCred\n)\n\nCREATE EXTERNAL TABLE Flights\n ([DayofMonth] INT\n,[DayOfWeek] INT\n,[DepTime] VARCHAR(50)\n,[CRSDepTime] VARCHAR(50)\n,[ArrTime]  VARCHAR(50)\n,[CRSArrTime]  VARCHAR(50)\n,[UniqueCarrier] VARCHAR(50)\n,[FlightNum] VARCHAR(50)\n,[TailNum] VARCHAR(50)\n,[ActualElapsedTime] INT\n,[CRSElapsedTime] INT\n,[AirTime] INT\n,[ArrDelay] INT\n,[DepDelay] INT\n,[Origin] VARCHAR(50)\n,[Destination] VARCHAR(50)\n,[Distance] INT\n,[TaxiIn] INT\n,[TaxiOut] INT\n,[Cancelled] BIT\n,[CancelledCode] VARCHAR(50)\n,[Diverted] BIT\n,[CarrierDelay] VARCHAR(50)\n,[WeatherDelay] VARCHAR(50)\n,[NASDelay] VARCHAR(50)\n,[SecurityDelay] VARCHAR(50)\n,[LateAircraftDelay] VARCHAR(50)\n,[IsArrDelayed] BIT\n,[IsDepDelayed] BIT\n,[Year] INT\n,[Month] INT)\nWITH\n(\n\tLOCATION = '/flightpq4',\n\tDATA_SOURCE = [myGen2FS],\n\tFILE_FORMAT = [SynapseParquetFormat]\n)\n\nSELECT TOP (100) [DayofMonth]\n,[DayOfWeek]\n,[DepTime]\n,[CRSDepTime]\n,[ArrTime]\n,[CRSArrTime]\n,[UniqueCarrier]\n,[FlightNum]\n,[TailNum]\n,[ActualElapsedTime]\n,[CRSElapsedTime]\n,[AirTime]\n,[ArrDelay]\n,[DepDelay]\n,[Origin]\n,[Destination]\n,[Distance]\n,[TaxiIn]\n,[TaxiOut]\n,[Cancelled]\n,[CancelledCode]\n,[Diverted]\n,[CarrierDelay]\n,[WeatherDelay]\n,[NASDelay]\n,[SecurityDelay]\n,[LateAircraftDelay]\n,[IsArrDelayed]\n,[IsDepDelayed]\n,[Year]\n,[Month]\n FROM [dbo].[Flights]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "FlightsData",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}
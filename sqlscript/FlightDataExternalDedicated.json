{
	"name": "FlightDataExternalDedicated",
	"properties": {
		"content": {
			"query": "CREATE MASTER KEY ENCRYPTION BY PASSWORD='BoobooBooboo!';\n\nCREATE DATABASE SCOPED CREDENTIAL BlobCred \nWITH \n  IDENTITY = 'SHARED ACCESS SIGNATURE',\n  SECRET = 'sv=2021-06-08&st=2022-11-20T21%3A06%3A29Z&se=2022-11-21T21%3A06%3A29Z&sr=c&sp=rl&sig=UdUZPLP1tLFIqNuRh8LVnb0zGBGHtJhj%2FgE8hEIzkF0%3D';\n\nCREATE EXTERNAL DATA SOURCE BlueBadge\nWITH \n  (LOCATION = 'abfss://bluebadgegen2fs@bluebadgegen22sa.dfs.core.windows.net',\n  CREDENTIAL = BlobCred)\n\nCREATE EXTERNAL FILE FORMAT BBIParquet\nWITH (\n  FORMAT_TYPE = PARQUET\n  )\n\nCREATE EXTERNAL TABLE FlightDataExternal(\n    [Year] INT,\n    [Month] INT,\n    DayofMonth INT,\n    DayOfWeek INT,\n    DepTime VARCHAR(8000),\n    CRSDepTime VARCHAR(8000),\n    ArrTime VARCHAR(8000),\n    CRSArrTime VARCHAR(8000),\n    NASDelay VARCHAR(8000),\n    SecurityDelay VARCHAR(8000),\n    LateAircraftDelay VARCHAR(8000),\n    IsArrDelayed BIT,\n    IsDepDelayed BIT,\n    TaxiOut INT,\n    Cancelled BIT,\n    CancelledCode VARCHAR(8000),\n    Diverted BIT,\n    CarrierDelay VARCHAR(8000),\n    WeatherDelay VARCHAR(8000),\n    ArrDelay INT,\n    DepDelay INT,\n    Origin VARCHAR(8000),\n    Destination VARCHAR(8000),\n    Distance INT,\n    TaxiIn INT,\n    UniqueCarrier VARCHAR(8000),\n    FlightNum VARCHAR(8000),\n    TailNum VARCHAR(8000),\n    ActualElapsedTime INT,\n    CRSElapsedTime INT,\n    AirTime INT\n)\nWITH (\n  LOCATION = '/flightonefile',\n  DATA_SOURCE = BlueBadge,\n  FILE_FORMAT = BBIParquet\n)\n\nSELECT \n    [Year], \n    [Month],\n    DayofMonth,\n    DayOfWeek,\n    DepTime,\n    CRSDepTime,\n    ArrTime,\n    CRSArrTime,\n    NASDelay,\n    SecurityDelay,\n    LateAircraftDelay,\n    TaxiOut,\n    CancelledCode,\n    CarrierDelay,\n    WeatherDelay,\n    ArrDelay,\n    DepDelay,\n    Origin,\n    Destination,\n    Distance,\n    TaxiIn,\n    UniqueCarrier,\n    FlightNum,\n    TailNum,\n    ActualElapsedTime,\n    CRSElapsedTime,\n    AirTime\nINTO FlightDataInternal\nFROM FlightDataExternal\n  \nSELECT Year, Month, COUNT(*) FROM FlightDataInternal GROUP BY Year, Month ORDER BY Year, Month\n\nCREATE CLUSTERED COLUMNSTORE INDEX FlightDataCCI ON FlightDataInternal\n\nSELECT Year, Month, COUNT(*) FROM FlightDataInternal GROUP BY Year, Month ORDER BY Year, Month\n\nCREATE CLUSTERED COLUMNSTORE INDEX FlightDataCCI ON FlightDataInternal\nORDER (Year, Month)\nWITH (DROP_EXISTING = ON)\n\nSELECT Year, Month, COUNT(*) FROM FlightDataInternal GROUP BY Year, Month ORDER BY Year, Month\n\nDROP TABLE FlightDataInternal\nDROP EXTERNAL TABLE FlightDataExternal\nDROP EXTERNAL FILE FORMAT BBIParquet\nDROP EXTERNAL DATA SOURCE BlueBadge\nDROP DATABASE SCOPED CREDENTIAL BlobCred\nDROP MASTER KEY",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SampleSQL",
				"poolName": "SampleSQL"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}